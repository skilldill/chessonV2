---
import Layout from "../../layouts/Layout.astro";
import { Chessboard3D } from "../../components/Chessboard3D";
---

<Layout 
	lang="ru" 
	title="Онлайн шахматы — играй бесплатно с друзьями"
	description="Играйте в шахматы онлайн без регистрации. Создавайте комнаты, приглашайте друзей и делайте ходы прямо в браузере."
	canonicalUrl="https://chesson.me/ru/"
	ogImage="https://chesson.me/og.png"
	locale="ru_RU"
>
	<div class="relative w-full h-screen bg-black text-white overflow-hidden">
		<header class="absolute top-0 left-0 right-0 z-10 p-9">
			<nav class="flex justify-between items-center max-w-6xl mx-auto">
				<div class="flex items-center">
					<img src="/chesson-logo.svg" alt="Chesson Logo" />
				</div>
			</nav>
		</header>
		<div
			class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10 text-center"
		>
			<h1 class="font-bold mb-8 max-w-4xl mx-auto text-3xl sm:text-4xl md:text-5xl lg:text-7xl">
				Онлайн шахматы — играй бесплатно с друзьями
			</h1>
			<h2 class="mb-10 font-normal text-xl sm:text-2xl md:text-3xl lg:text-4xl">
				Создай комнату за секунду и начни партию без регистрации
			</h2>
			<button
				id="create-room-btn"
				class="bg-white text-black font-bold py-3 px-6 rounded-md hover:bg-gray-200 transition duration-300 text-lg cursor-pointer"
			>
				Создать комнату
			</button>
		</div>
		<Chessboard3D client:only />
	</div>
	<script>
		const API_URL = import.meta.env.DEV ? 'http://localhost:4000' : 'https://chesson.me/api';
		
		document.getElementById('create-room-btn')?.addEventListener('click', async () => {
			try {
				const response = await fetch(`${API_URL}/api/rooms`, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify({})
				});
				
				if (!response.ok) {
					throw new Error('Failed to create room');
				}
				
				const data = await response.json();
				
				if (data.success && data.roomId) {
					window.location.href = import.meta.env.DEV ? `http://localhost:5173/${data.roomId}` : `https://chesson.me/game/${data.roomId}`;
				}
			} catch (error) {
				console.error('Error creating room:', error);
				alert('Не удалось создать комнату. Попробуйте снова.');
			}
		});
	</script>
</Layout>
